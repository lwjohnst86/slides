---
title: "MELD Project: *M*etabolic consequences of *E*arly *L*ife adversity and risk for type 2 *D*iabetes"
author: "Luke W. Johnston"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["xaringan-themer.css", "../../common/custom.css"]
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: ""
---

layout: true

<div class="my-footer">
<span>
<img src="`r lwj::logo('dda')`" alt="DDA", width="75">
<img src="`r lwj::logo('sdca')`" alt="SDCA", width="55">
<a href="https://slides.lwjohnst.com/dda/2020-02-06/">slides.lwjohnst.com/dda/2020-02-06</a>
</span>
</div> 

<div class="my-header">
`r lwj::qrencode_svg("https://slides.lwjohnst.com/dda/2020-02-06/", size = 2)`
</div> 

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(kableExtra)
library(tidyverse)
knitr::opts_chunk$set(
  echo = FALSE,
  dev = "png",
  dpi = 150,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.align = "center"
)

image_dda_path <- function(.file) {
    fs::path("..", "..", "dda", "2020-02-04", "images", .file)
}

image_nc_path <- function(.file) {
    fs::path("..", "..", "au-ph", "2019-08-15", "images", .file)
}

fa2 <- function(.icon) {
    fontawesome::fa(name = .icon, fill = "#214c78")
}
```

```{r xaringan-themer, include=FALSE}
library(xaringanthemer)
mono_accent(
    base_color = "#214c78",
    header_font_google = google_font("Monda"),
    text_font_google = google_font("Rosario"),
    header_h1_font_size = "52px",
    header_h2_font_size = "48px",
    text_font_size = "25px"
)
```

---

# Purpose:

- Seek feedback

- Show my project

- Share about:
    - Early life influences
    - Analytic technique
    - Open science practices

---

class: center, middle

# MELD Project Description

---

## Background and rationale

- Early life shown to influence risk of diabetes

- How do metabolic processes mediate this link (in humans)? `r emo::ji("shrug")`

- Difficult to study due to long timespans
--


- Easier now with:
    - Registers
    - Cohort `r fa2("link")` with registers
    - Powerful mediation methods

---

## Some potential mechanisms

- Impairs organ development (e.g cell numbers)

- Affects insulin sensitivity pathways (e.g. in muscle)

- Altered lifestyle behaviours

- Excessive stress responses

---

## Public health and clinical relevance

.pull-left[
**Adversity of trauma**:

- Refugees

- Immigration

- Childhood abuse

- Poor or unsafe neighbourhood
]

--

.pull-right[
**Adversity of excess**:

- Childhood obesity

- Low-nutrient dense foods

- Lack of exercise
]

???

For my project, I won't be covering the adversity of excess.

---

## Research questions:

- *Overall aim*: Better quantify and understand impact of general early life
(mainly childhood) conditions on adult metabolic capacity and risk for T2D.

- *Specific objectives*:
    1. Investigate how specific early childhood conditions affect risk of T2D
    2. Identify mediating pathways of metabolic capacity between early
    childhood adversity and T2D with NetCoupler

--

- To address 2., must also:
    - Extend and generalise NetCoupler algorithm
    ([github.com/NetCoupler](https://github.com/NetCoupler/NetCoupler)) 
    - Direct and mediating pathway estimation
    
???

I'm being intentionally vague about meaning of "early childhood conditions" because
what conditions I use depends on the data that's available and what may better
represent "adversity". This will require some exploratory work at objective 1.
to then use in objective 2.

---

## Identifying population with Lexis diagram

```{r img-lexis, out.width="70%"}
knitr::include_graphics(image_dda_path("lexis-diagram.svg"))
```

---

## Identifying variables with DAG

```{r img-dag, out.width="85%"}
knitr::include_graphics(image_dda_path("dag.svg"))
```

---

## For objectives, need to analyze data like this...

```{r img-model-handles-data, out.width="75%"}
knitr::include_graphics(image_nc_path("network.png"))
```

---

class: center, middle

# Current Analytic Problem

---

## Modern studies generate lots of metabolic data 

.pull-left[
- -omics type data

- Metabolic biomarkers
]

.pull-right[
- High dimensionality

- Complex networks
]

---

## "Traditional" analysis may use: Dimensionality reduction

```{r img-traditional-pca, fig.cap="Reducing number of variables with PCA"}
knitr::include_graphics(image_nc_path("pca.png"))
```

???

This has the advantage of making things simpler while trying to maximize
variance in the data. Afterward you can do modelling on each principal component.
The disadvantage of this approach is that it loses a lot of information since
the interdependence and connections between variables it not maintained.

---

## "Traditional" analysis may use: Many regression-type models

.center[
```
O1 = M1 + covariates
O1 = M2 + covariates
...
O1 = M7 + covariates
O1 = M8 + covariates
```
]

???

Some ways you might go about analyzing this data is by running many regression
models, one for each metabolic variable for instance.

This of course has problems since you're simply running a bunch of models and
not taking account of the inherent interdependencies between variables.

---

## "Traditional" analysis may use: Network analysis

```{r img-traditional-network-analysis, fig.height=3.5, fig.width=6, out.width="50%", out.height="50%"}
library(ggdag)
library(dagitty)
g1 <- dagitty( "dag {
    X5 -> X1 -> X2 -> Y
    X1 <- X4 -> X3
    X2 -> X3 -> Y
    X -> Y
    X <-> X5 <-> X2 <-> Y
}")

ggdag(g1, seed = 154426) +
    theme_dag()
```

???

This approach is nice in that you can extract information about the connection
between metabolic variables. But there is no way to incorporate the disease
outcome with this approach and in order to construct the network properly most
methods require you provide a prespecified base network, which you might not know.

---

## But, what if we...

- want info about network structure?
--


- don't know the network structure?
--


- have an exposure, metabolites, and outcome?
--


- are interested in causal links?

---

## What if we want to know something like this?

```{r img-data-like-this, out.width="75%"}
knitr::include_graphics(image_nc_path("network.png"))
```

---

## Potential solution: NetCoupler

.pull-left[
**Causal structure learning** that ...

- Finds most likely network structure

- Allows inclusion of exposure and outcome

- Identifies causal links between and within network
]

.pull-right[
![Clemens Wittenbecher](https://avatars3.githubusercontent.com/u/33724052?size=200)
]

.footnote[NetCoupler algorithm was developed by Clemens Wittenbecher.]

---

## NetCoupler algorithm overview

```{r img-netcoupler, out.width="75%"}
knitr::include_graphics(image_dda_path("netcoupler-process.svg"))
```


---

## Infer (potentially) causal pathways with graphical model

```{r img-nc-pathways, out.width="85%"}
knitr::include_graphics(image_nc_path("nc-causal-pathways.png"))
```

---

## Overall analysis with NetCoupler

```{r img-methods, out.width="65%"}
knitr::include_graphics(image_dda_path("methods.svg"))
```

---

## Current state of project

- Developing NetCoupler `r fa2("r-project")` `r emo::ji("package")` 
    - [github.com/NetCoupler](https://github.com/NetCoupler)
--


- Developing protocol to register study
        - MELD Project Protocol: `fa2("file-alt")` [lwjohnst.gitlab.io/meld-protocol](https://lwjohnst.gitlab.io/meld-protocol)

---

class: center, middle

# Open science

---

class: center, middle

## Question: 

## How many know or have heard or know about <u>open science</u>?

---

class: center, middle

## Question: 

## ...or <u>open access, open methods, open data, or open source</u>?

---

## How does this relate to my project?

---

## What is open science

- About transparency of process to making claim
- Summary of how common science studies do open science

---

## Open science: Terms and meanings

.center[

| **Term** | **Meaning** |
|:------------|:---------------|
| Open science | Freely available, openly licensed .red.bold[*] material for all things related to scientific activity |
| Open access | Free, unrestricted, publicly available **published articles** |
| Open data | Freely available, re-usable, openly licensed **data** |
| Open source/code | Freely available, re-usable, openly licensed **scientific code** used in generating results |
| Open methods/protocol | Freely available, re-usable, openly licensed **methods and protocols** used to create the data |

]

---

class: middle, center

# Algorithm (steps) used in NetCoupler

---

### 1. DAG skeleton of network is estimated

```{r img-nc-1, out.height="100%"}
knitr::include_graphics(image_nc_path("nc-step-1.png"))
```

---

### 2. Initial links formed on exposure-side

```{r img-nc-2, out.width="65%"}
knitr::include_graphics(image_nc_path("nc-step-2.png"))
```

---

### 3. Direct effects estimated between exposure and network

```{r img-nc-3, out.width="55%"}
knitr::include_graphics(image_nc_path("nc-step-3.png"))
```

---

### 4. Repeat identifying links, find ambiguous, delete indirect links

```{r img-nc-4, out.width="55%"}
knitr::include_graphics(image_nc_path("nc-step-4.png"))
```

???

If you were interested in linkages with an exposure on the network, you could
stop here.

---

### 5. Initial links formed with outcome-side

```{r, out.width="65%"}
knitr::include_graphics(image_nc_path("nc-step-5.png"))
```

---

### 6. Direct effects estimated between network and outcome

```{r img-nc-6, out.width="65%"}
knitr::include_graphics(image_nc_path("nc-step-6.png"))
```

---

### 7. Repeat identifying links, delete indirect links, find ambiguous

```{r img-nc-7, out.width="65%"}
knitr::include_graphics(image_nc_path("nc-step-7.png"))
```

???

You could stop here if you were interested in linkages with the network and an
outcome.

---

### 8. (optional) Combine both estimations into joint model

```{r img-nc-8, out.width="85%"}
knitr::include_graphics(image_nc_path("nc-step-8.png"))
```
